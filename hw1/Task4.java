import java.util.ArrayList;
import java.util.LinkedList;

    /*
    Связность = минимальное число параллельных связей между любой парой узлов
     */

    /*
    Использованный алгоритм:
    отметим, что в наших определениях связность совпадает с величиной максимального потока из теории графов
    (если в качестве весов для ребер мы будем указывать окличество этих ребер между двумя вершинами).
    Тут можно использовать, например, алгоритм Форда-Фалкерсона, который дейтвует через dfs
    Сложность: O(Ef), где E - число ребер графа (можно брать n^2), f - максмальный поток
    Вызываем для каждой пары компьютеров, имеем: O(n^4)
     */

    /*
    Сложность алгоритма неиспользованного алгоритма (с топологической сортировкой):
    dfs дает O(n^2)
    вторая часть топологической сортировки, где вычисляются путь, тоже за O(n^2), они последовательно вычисляются
    Значит в итоге функция topologySort исполняется за O(n^2)
    Она вызывается для каждой пары копмпьютеров в сети, что дает нам O(n^4)
     */

public class Task4 {
    public static void main(String[] args) {

        //input data
        // Here I've replaced "[" by "{" like it is in Java
        int[][] myNet = {{0, 5}, {0, 6}, {0, 7}, {0, 7}, {0, 7}, {0, 8}, {0, 12}, {0, 23}, {0, 26}, {0, 27}, {0, 29}, {0, 32}, {0, 33}, {0, 36}, {0, 45}, {0, 51}, {0, 55}, {0, 55}, {0, 57}, {0, 60}, {0, 60}, {0, 66}, {0, 66}, {0, 68}, {0, 68}, {0, 72}, {0, 73}, {0, 77}, {0, 78}, {0, 79}, {0, 93}, {0, 93}, {0, 97}, {1, 11}, {1, 16}, {1, 17}, {1, 18}, {1, 20}, {1, 21}, {1, 28}, {1, 38}, {1, 40}, {1, 40}, {1, 40}, {1, 42}, {1, 43}, {1, 48}, {1, 54}, {1, 61}, {1, 71}, {1, 74}, {1, 80}, {1, 83}, {1, 83}, {1, 83}, {1, 87}, {1, 87}, {2, 8}, {2, 12}, {2, 12}, {2, 19}, {2, 22}, {2, 23}, {2, 27}, {2, 31}, {2, 32}, {2, 32}, {2, 33}, {2, 34}, {2, 39}, {2, 44}, {2, 45}, {2, 50}, {2, 55}, {2, 57}, {2, 62}, {2, 77}, {2, 78}, {2, 79}, {2, 79}, {2, 85}, {2, 97}, {2, 97}, {2, 98}, {3, 4}, {3, 4}, {3, 14}, {3, 14}, {3, 20}, {3, 21}, {3, 25}, {3, 30}, {3, 43}, {3, 47}, {3, 47}, {3, 48}, {3, 54}, {3, 58}, {3, 58}, {3, 59}, {3, 65}, {3, 65}, {3, 70}, {3, 70}, {3, 71}, {3, 71}, {3, 75}, {3, 76}, {3, 81}, {3, 87}, {3, 92}, {3, 92}, {3, 95}, {3, 96}, {4, 11}, {4, 11}, {4, 14}, {4, 15}, {4, 16}, {4, 21}, {4, 28}, {4, 30}, {4, 30}, {4, 30}, {4, 38}, {4, 42}, {4, 46}, {4, 48}, {4, 49}, {4, 53}, {4, 53}, {4, 61}, {4, 61}, {4, 70}, {4, 71}, {4, 71}, {4, 74}, {4, 75}, {4, 76}, {4, 80}, {4, 83}, {4, 83}, {4, 84}, {4, 84}, {4, 84}, {4, 87}, {4, 87}, {4, 88}, {4, 91}, {4, 92}, {4, 92}, {4, 96}, {5, 8}, {5, 12}, {5, 19}, {5, 19}, {5, 22}, {5, 23}, {5, 23}, {5, 23}, {5, 26}, {5, 29}, {5, 31}, {5, 34}, {5, 34}, {5, 34}, {5, 34}, {5, 34}, {5, 35}, {5, 37}, {5, 39}, {5, 39}, {5, 44}, {5, 56}, {5, 64}, {5, 66}, {5, 72}, {5, 73}, {5, 79}, {5, 79}, {5, 85}, {5, 85}, {5, 86}, {5, 97}, {5, 98}, {6, 12}, {6, 22}, {6, 22}, {6, 32}, {6, 32}, {6, 35}, {6, 35}, {6, 37}, {6, 37}, {6, 39}, {6, 39}, {6, 44}, {6, 44}, {6, 45}, {6, 57}, {6, 60}, {6, 62}, {6, 62}, {6, 63}, {6, 69}, {6, 69}, {6, 72}, {6, 73}, {6, 77}, {6, 77}, {6, 77}, {6, 78}, {6, 86}, {6, 86}, {6, 89}, {6, 97}, {7, 26}, {7, 27}, {7, 29}, {7, 29}, {7, 34}, {7, 35}, {7, 36}, {7, 37}, {7, 45}, {7, 45}, {7, 50}, {7, 50}, {7, 51}, {7, 55}, {7, 56}, {7, 60}, {7, 60}, {7, 60}, {7, 64}, {7, 66}, {7, 66}, {7, 68}, {7, 68}, {7, 73}, {7, 74}, {7, 78}, {7, 79}, {7, 82}, {7, 98}, {8, 23}, {8, 27}, {8, 31}, {8, 32}, {8, 33}, {8, 33}, {8, 33}, {8, 34}, {8, 36}, {8, 37}, {8, 37}, {8, 39}, {8, 41}, {8, 44}, {8, 45}, {8, 51}, {8, 52}, {8, 52}, {8, 52}, {8, 55}, {8, 60}, {8, 60}, {8, 66}, {8, 78}, {8, 86}, {8, 86}, {8, 89}, {8, 93}, {8, 93}, {8, 94}, {8, 97}, {9, 11}, {9, 14}, {9, 14}, {9, 16}, {9, 17}, {9, 17}, {9, 20}, {9, 21}, {9, 25}, {9, 25}, {9, 25}, {9, 32}, {9, 38}, {9, 38}, {9, 40}, {9, 42}, {9, 46}, {9, 49}, {9, 49}, {9, 49}, {9, 53}, {9, 58}, {9, 59}, {9, 65}, {9, 70}, {9, 75}, {9, 81}, {9, 87}, {9, 87}, {9, 91}, {9, 92}, {9, 99}, {10, 11}, {10, 15}, {10, 17}, {10, 17}, {10, 18}, {10, 18}, {10, 20}, {10, 21}, {10, 25}, {10, 25}, {10, 30}, {10, 30}, {10, 42}, {10, 42}, {10, 43}, {10, 46}, {10, 48}, {10, 49}, {10, 49}, {10, 49}, {10, 59}, {10, 70}, {10, 74}, {10, 74}, {10, 76}, {10, 76}, {10, 76}, {10, 80}, {10, 81}, {10, 81}, {10, 84}, {10, 87}, {10, 91}, {10, 91}, {10, 92}, {10, 95}, {10, 95}, {10, 96}, {10, 96}, {10, 96}, {10, 99}, {11, 13}, {11, 15}, {11, 16}, {11, 18}, {11, 25}, {11, 28}, {11, 38}, {11, 48}, {11, 48}, {11, 53}, {11, 58}, {11, 61}, {11, 65}, {11, 65}, {11, 67}, {11, 70}, {11, 71}, {11, 74}, {11, 74}, {11, 74}, {11, 75}, {11, 76}, {11, 81}, {11, 84}, {11, 90}, {11, 96}, {11, 99}, {12, 22}, {12, 27}, {12, 31}, {12, 31}, {12, 34}, {12, 35}, {12, 35}, {12, 36}, {12, 36}, {12, 36}, {12, 37}, {12, 41}, {12, 44}, {12, 45}, {12, 46}, {12, 50}, {12, 52}, {12, 52}, {12, 55}, {12, 55}, {12, 55}, {12, 60}, {12, 62}, {12, 64}, {12, 66}, {12, 69}, {12, 69}, {12, 73}, {12, 77}, {12, 85}, {12, 86}, {12, 89}, {12, 93}, {12, 97}, {12, 98}, {13, 15}, {13, 17}, {13, 20}, {13, 24}, {13, 25}, {13, 43}, {13, 43}, {13, 46}, {13, 47}, {13, 49}, {13, 49}, {13, 53}, {13, 53}, {13, 53}, {13, 54}, {13, 58}, {13, 58}, {13, 71}, {13, 71}, {13, 76}, {13, 80}, {13, 81}, {13, 83}, {13, 87}, {13, 91}, {13, 95}, {14, 15}, {14, 15}, {14, 17}, {14, 18}, {14, 20}, {14, 20}, {14, 21}, {14, 21}, {14, 28}, {14, 38}, {14, 40}, {14, 42}, {14, 42}, {14, 47}, {14, 47}, {14, 48}, {14, 48}, {14, 49}, {14, 61}, {14, 61}, {14, 65}, {14, 67}, {14, 74}, {14, 75}, {14, 81}, {14, 92}, {14, 95}, {14, 95}, {15, 16}, {15, 17}, {15, 21}, {15, 25}, {15, 30}, {15, 40}, {15, 42}, {15, 43}, {15, 43}, {15, 43}, {15, 46}, {15, 46}, {15, 49}, {15, 53}, {15, 54}, {15, 67}, {15, 80}, {15, 81}, {15, 81}, {15, 81}, {15, 83}, {15, 84}, {15, 87}, {15, 88}, {15, 91}, {15, 92}, {15, 99}, {16, 17}, {16, 18}, {16, 20}, {16, 21}, {16, 25}, {16, 25}, {16, 30}, {16, 38}, {16, 42}, {16, 42}, {16, 42}, {16, 43}, {16, 43}, {16, 47}, {16, 47}, {16, 49}, {16, 61}, {16, 67}, {16, 67}, {16, 67}, {16, 70}, {16, 71}, {16, 71}, {16, 75}, {16, 76}, {16, 84}, {16, 87}, {16, 88}, {16, 91}, {16, 95}, {16, 95}, {16, 96}, {16, 96}, {17, 21}, {17, 30}, {17, 38}, {17, 38}, {17, 38}, {17, 48}, {17, 54}, {17, 54}, {17, 58}, {17, 65}, {17, 67}, {17, 70}, {17, 70}, {17, 71}, {17, 74}, {17, 81}, {17, 81}, {17, 81}, {17, 83}, {17, 88}, {17, 92}, {17, 96}, {17, 99}, {17, 99}, {18, 20}, {18, 40}, {18, 48}, {18, 58}, {18, 61}, {18, 65}, {18, 65}, {18, 70}, {18, 74}, {18, 75}, {18, 76}, {18, 80}, {18, 80}, {18, 80}, {18, 81}, {18, 83}, {18, 84}, {18, 84}, {18, 88}, {18, 88}, {18, 88}, {18, 88}, {18, 90}, {18, 90}, {18, 92}, {18, 94}, {18, 95}, {18, 96}, {18, 99}, {18, 99}, {18, 99}, {19, 22}, {19, 29}, {19, 29}, {19, 31}, {19, 32}, {19, 33}, {19, 34}, {19, 35}, {19, 36}, {19, 36}, {19, 37}, {19, 39}, {19, 50}, {19, 52}, {19, 52}, {19, 55}, {19, 56}, {19, 56}, {19, 57}, {19, 60}, {19, 63}, {19, 63}, {19, 63}, {19, 63}, {19, 68}, {19, 73}, {19, 73}, {19, 86}, {19, 93}, {20, 21}, {20, 25}, {20, 28}, {20, 42}, {20, 46}, {20, 47}, {20, 47}, {20, 47}, {20, 48}, {20, 58}, {20, 67}, {20, 67}, {20, 71}, {20, 72}, {20, 74}, {20, 75}, {20, 76}, {20, 83}, {20, 83}, {20, 87}, {20, 90}, {20, 90}, {20, 99}, {21, 25}, {21, 30}, {21, 30}, {21, 40}, {21, 40}, {21, 43}, {21, 47}, {21, 49}, {21, 53}, {21, 58}, {21, 59}, {21, 59}, {21, 65}, {21, 65}, {21, 76}, {21, 80}, {21, 83}, {21, 83}, {21, 83}, {21, 84}, {21, 91}, {22, 26}, {22, 26}, {22, 27}, {22, 31}, {22, 34}, {22, 34}, {22, 35}, {22, 35}, {22, 39}, {22, 39}, {22, 44}, {22, 50}, {22, 51}, {22, 56}, {22, 57}, {22, 62}, {22, 63}, {22, 63}, {22, 64}, {22, 66}, {22, 66}, {22, 69}, {22, 69}, {22, 73}, {22, 77}, {22, 78}, {22, 79}, {22, 86}, {22, 86}, {22, 93}, {22, 94}, {22, 97}, {23, 31}, {23, 32}, {23, 33}, {23, 33}, {23, 33}, {23, 34}, {23, 34}, {23, 35}, {23, 36}, {23, 41}, {23, 45}, {23, 51}, {23, 60}, {23, 62}, {23, 63}, {23, 64}, {23, 68}, {23, 73}, {23, 73}, {23, 73}, {23, 73}, {23, 77}, {23, 89}, {23, 89}, {23, 93}, {23, 93}, {23, 93}, {23, 94}, {23, 98}, {24, 28}, {24, 38}, {24, 43}, {24, 46}, {24, 46}, {24, 48}, {24, 53}, {24, 58}, {24, 61}, {24, 74}, {24, 80}, {24, 80}, {24, 81}, {24, 88}, {24, 90}, {24, 91}, {24, 91}, {24, 92}, {24, 95}, {24, 95}, {24, 96}, {24, 96}, {24, 99}, {25, 40}, {25, 43}, {25, 49}, {25, 54}, {25, 54}, {25, 58}, {25, 59}, {25, 59}, {25, 61}, {25, 67}, {25, 67}, {25, 70}, {25, 70}, {25, 74}, {25, 75}, {25, 76}, {25, 87}, {25, 88}, {25, 90}, {25, 90}, {25, 91}, {25, 92}, {25, 96}, {25, 99}, {26, 29}, {26, 29}, {26, 31}, {26, 32}, {26, 32}, {26, 34}, {26, 34}, {26, 35}, {26, 36}, {26, 44}, {26, 44}, {26, 51}, {26, 51}, {26, 55}, {26, 57}, {26, 60}, {26, 66}, {26, 72}, {26, 82}, {26, 85}, {26, 85}, {26, 86}, {26, 94}, {26, 97}, {26, 98}, {27, 31}, {27, 31}, {27, 33}, {27, 35}, {27, 36}, {27, 41}, {27, 41}, {27, 44}, {27, 45}, {27, 45}, {27, 50}, {27, 52}, {27, 57}, {27, 60}, {27, 64}, {27, 78}, {27, 79}, {27, 82}, {27, 82}, {27, 86}, {27, 86}, {27, 93}, {27, 94}, {27, 94}, {27, 97}, {28, 30}, {28, 30}, {28, 38}, {28, 40}, {28, 46}, {28, 49}, {28, 54}, {28, 58}, {28, 58}, {28, 59}, {28, 67}, {28, 67}, {28, 70}, {28, 70}, {28, 74}, {28, 75}, {28, 83}, {28, 88}, {28, 90}, {28, 91}, {28, 95}, {28, 96}, {28, 99}, {28, 99}, {28, 99}, {29, 32}, {29, 33}, {29, 34}, {29, 35}, {29, 36}, {29, 37}, {29, 37}, {29, 44}, {29, 56}, {29, 57}, {29, 62}, {29, 63}, {29, 64}, {29, 64}, {29, 66}, {29, 72}, {29, 77}, {29, 78}, {29, 78}, {29, 78}, {29, 79}, {29, 82}, {29, 85}, {29, 85}, {29, 93}, {30, 47}, {30, 48}, {30, 54}, {30, 58}, {30, 59}, {30, 67}, {30, 71}, {30, 75}, {30, 75}, {30, 90}, {30, 95}, {30, 95}, {30, 99}, {30, 99}, {30, 99}, {31, 34}, {31, 36}, {31, 37}, {31, 41}, {31, 44}, {31, 44}, {31, 51}, {31, 55}, {31, 56}, {31, 60}, {31, 62}, {31, 62}, {31, 64}, {31, 68}, {31, 69}, {31, 72}, {31, 72}, {31, 77}, {31, 79}, {31, 93}, {31, 94}, {31, 94}, {32, 34}, {32, 35}, {32, 39}, {32, 39}, {32, 39}, {32, 39}, {32, 39}, {32, 39}, {32, 44}, {32, 45}, {32, 50}, {32, 51}, {32, 51}, {32, 52}, {32, 55}, {32, 60}, {32, 64}, {32, 64}, {32, 68}, {32, 69}, {32, 73}, {32, 78}, {32, 78}, {32, 82}, {32, 85}, {32, 86}, {32, 89}, {32, 93}, {32, 93}, {32, 97}, {32, 98}, {33, 37}, {33, 44}, {33, 44}, {33, 45}, {33, 45}, {33, 50}, {33, 51}, {33, 52}, {33, 57}, {33, 62}, {33, 64}, {33, 66}, {33, 69}, {33, 72}, {33, 73}, {33, 79}, {33, 86}, {33, 89}, {33, 93}, {33, 97}, {33, 98}, {34, 35}, {34, 36}, {34, 37}, {34, 41}, {34, 41}, {34, 51}, {34, 55}, {34, 55}, {34, 56}, {34, 63}, {34, 63}, {34, 66}, {34, 72}, {34, 73}, {34, 78}, {34, 82}, {34, 82}, {34, 89}, {34, 97}, {34, 97}, {35, 36}, {35, 39}, {35, 44}, {35, 45}, {35, 51}, {35, 52}, {35, 56}, {35, 60}, {35, 64}, {35, 68}, {35, 68}, {35, 72}, {35, 73}, {35, 73}, {35, 78}, {35, 78}, {35, 82}, {35, 82}, {35, 98}, {36, 37}, {36, 37}, {36, 44}, {36, 50}, {36, 52}, {36, 60}, {36, 62}, {36, 63}, {36, 66}, {36, 69}, {36, 77}, {36, 77}, {36, 94}, {36, 94}, {36, 94}, {36, 98}, {36, 98}, {37, 39}, {37, 41}, {37, 51}, {37, 52}, {37, 55}, {37, 55}, {37, 62}, {37, 64}, {37, 66}, {37, 66}, {37, 66}, {37, 69}, {37, 72}, {37, 72}, {37, 72}, {37, 78}, {37, 82}, {37, 85}, {37, 93}, {37, 98}, {38, 49}, {38, 53}, {38, 54}, {38, 58}, {38, 59}, {38, 70}, {38, 74}, {38, 76}, {38, 80}, {38, 80}, {38, 80}, {38, 83}, {38, 88}, {38, 88}, {38, 90}, {38, 90}, {38, 91}, {38, 91}, {39, 45}, {39, 45}, {39, 50}, {39, 51}, {39, 51}, {39, 57}, {39, 57}, {39, 63}, {39, 63}, {39, 79}, {39, 82}, {39, 86}, {39, 97}, {39, 98}, {40, 46}, {40, 53}, {40, 59}, {40, 61}, {40, 65}, {40, 67}, {40, 70}, {40, 74}, {40, 75}, {40, 75}, {40, 83}, {40, 88}, {40, 91}, {40, 92}, {40, 95}, {40, 95}, {40, 96}, {40, 99}, {41, 44}, {41, 52}, {41, 57}, {41, 62}, {41, 64}, {41, 66}, {41, 68}, {41, 69}, {41, 73}, {41, 73}, {41, 77}, {41, 78}, {41, 78}, {41, 79}, {41, 79}, {41, 82}, {41, 85}, {41, 85}, {41, 85}, {41, 86}, {41, 89}, {41, 97}, {41, 97}, {41, 98}, {42, 43}, {42, 46}, {42, 47}, {42, 59}, {42, 67}, {42, 74}, {42, 83}, {42, 87}, {42, 88}, {42, 90}, {42, 91}, {42, 95}, {42, 96}, {42, 99}, {43, 54}, {43, 61}, {43, 61}, {43, 70}, {43, 70}, {43, 74}, {43, 74}, {43, 75}, {43, 80}, {43, 81}, {43, 84}, {43, 87}, {43, 90}, {43, 90}, {43, 91}, {43, 95}, {43, 96}, {44, 45}, {44, 50}, {44, 52}, {44, 57}, {44, 57}, {44, 60}, {44, 60}, {44, 62}, {44, 64}, {44, 77}, {44, 77}, {44, 78}, {44, 79}, {44, 82}, {44, 93}, {44, 94}, {44, 98}, {44, 98}, {45, 50}, {45, 52}, {45, 55}, {45, 56}, {45, 57}, {45, 64}, {45, 68}, {45, 73}, {45, 73}, {45, 82}, {45, 85}, {45, 85}, {45, 86}, {45, 86}, {45, 93}, {45, 97}, {45, 98}, {46, 48}, {46, 53}, {46, 53}, {46, 54}, {46, 58}, {46, 61}, {46, 61}, {46, 74}, {46, 74}, {46, 74}, {46, 76}, {46, 81}, {46, 81}, {46, 81}, {46, 88}, {46, 90}, {46, 95}, {46, 95}, {46, 99}, {47, 54}, {47, 54}, {47, 59}, {47, 69}, {47, 75}, {47, 76}, {47, 76}, {47, 80}, {47, 81}, {47, 81}, {47, 83}, {47, 88}, {47, 90}, {47, 90}, {47, 91}, {47, 92}, {47, 95}, {47, 96}, {47, 99}, {48, 54}, {48, 61}, {48, 70}, {48, 71}, {48, 74}, {48, 80}, {48, 81}, {48, 81}, {48, 81}, {48, 81}, {48, 84}, {48, 91}, {48, 92}, {48, 95}, {49, 53}, {49, 53}, {49, 65}, {49, 67}, {49, 67}, {49, 67}, {49, 67}, {49, 67}, {49, 71}, {49, 71}, {49, 74}, {49, 81}, {49, 81}, {49, 84}, {49, 84}, {49, 84}, {49, 90}, {49, 95}, {50, 51}, {50, 55}, {50, 56}, {50, 56}, {50, 56}, {50, 63}, {50, 64}, {50, 66}, {50, 73}, {50, 82}, {50, 89}, {50, 89}, {50, 89}, {50, 93}, {50, 94}, {50, 97}, {50, 97}, {51, 55}, {51, 57}, {51, 57}, {51, 60}, {51, 62}, {51, 66}, {51, 66}, {51, 66}, {51, 69}, {51, 72}, {51, 72}, {51, 77}, {51, 85}, {51, 89}, {51, 93}, {51, 97}, {51, 97}, {52, 56}, {52, 57}, {52, 69}, {52, 77}, {52, 79}, {52, 79}, {52, 82}, {52, 86}, {52, 89}, {52, 89}, {52, 93}, {52, 94}, {53, 59}, {53, 61}, {53, 61}, {53, 61}, {53, 67}, {53, 70}, {53, 71}, {53, 74}, {53, 84}, {53, 87}, {53, 87}, {53, 90}, {53, 91}, {53, 95}, {53, 96}, {54, 74}, {54, 74}, {54, 76}, {54, 80}, {54, 81}, {54, 84}, {54, 84}, {54, 88}, {54, 90}, {54, 90}, {54, 91}, {54, 96}, {54, 99}, {54, 99}, {55, 56}, {55, 64}, {55, 64}, {55, 69}, {55, 79}, {55, 85}, {55, 85}, {55, 89}, {55, 94}, {56, 60}, {56, 62}, {56, 68}, {56, 69}, {56, 72}, {56, 77}, {56, 78}, {56, 78}, {56, 78}, {56, 79}, {56, 79}, {56, 86}, {56, 97}, {57, 63}, {57, 63}, {57, 63}, {57, 64}, {57, 66}, {57, 68}, {57, 69}, {57, 72}, {57, 73}, {57, 73}, {57, 89}, {57, 97}, {58, 59}, {58, 59}, {58, 71}, {58, 75}, {58, 76}, {58, 88}, {58, 90}, {58, 92}, {58, 99}, {59, 67}, {59, 71}, {59, 71}, {59, 74}, {59, 75}, {59, 80}, {59, 81}, {59, 83}, {59, 84}, {59, 87}, {59, 87}, {59, 87}, {59, 88}, {59, 88}, {59, 91}, {59, 92}, {59, 92}, {60, 63}, {60, 63}, {60, 72}, {60, 77}, {60, 79}, {60, 85}, {60, 86}, {60, 89}, {60, 98}, {60, 98}, {61, 67}, {61, 75}, {61, 76}, {61, 81}, {61, 83}, {61, 87}, {61, 88}, {61, 92}, {61, 92}, {61, 95}, {61, 95}, {61, 99}, {62, 68}, {62, 73}, {62, 77}, {62, 77}, {62, 79}, {62, 85}, {62, 86}, {62, 89}, {63, 64}, {63, 68}, {63, 69}, {63, 69}, {63, 72}, {63, 82}, {63, 89}, {63, 93}, {63, 93}, {63, 94}, {63, 94}, {63, 98}, {64, 68}, {64, 69}, {64, 69}, {64, 77}, {64, 78}, {64, 80}, {64, 85}, {64, 86}, {64, 86}, {64, 97}, {65, 71}, {65, 74}, {65, 80}, {65, 81}, {65, 81}, {65, 81}, {65, 88}, {65, 90}, {65, 90}, {65, 91}, {65, 95}, {65, 99}, {65, 99}, {66, 68}, {66, 69}, {66, 69}, {66, 69}, {66, 77}, {66, 78}, {66, 78}, {66, 78}, {66, 78}, {66, 98}, {67, 71}, {67, 75}, {67, 76}, {67, 80}, {67, 84}, {67, 87}, {67, 88}, {67, 90}, {67, 92}, {67, 99}, {68, 69}, {68, 72}, {68, 77}, {68, 78}, {68, 82}, {68, 89}, {68, 93}, {68, 93}, {68, 97}, {68, 97}, {69, 72}, {69, 78}, {69, 85}, {69, 85}, {69, 94}, {69, 97}, {69, 98}, {69, 98}, {69, 98}, {69, 98}, {70, 76}, {70, 76}, {70, 80}, {70, 80}, {70, 84}, {70, 88}, {70, 90}, {70, 96}, {71, 76}, {71, 76}, {71, 81}, {71, 81}, {71, 83}, {71, 87}, {71, 87}, {71, 87}, {71, 91}, {71, 91}, {71, 95}, {71, 96}, {72, 86}, {72, 89}, {72, 94}, {73, 79}, {73, 82}, {73, 85}, {73, 94}, {73, 94}, {73, 94}, {73, 97}, {73, 97}, {73, 98}, {73, 98}, {74, 80}, {74, 84}, {74, 91}, {74, 92}, {74, 95}, {74, 95}, {74, 96}, {74, 96}, {74, 99}, {75, 76}, {75, 76}, {75, 80}, {75, 81}, {75, 84}, {75, 84}, {75, 95}, {75, 96}, {75, 99}, {76, 80}, {76, 80}, {76, 81}, {76, 83}, {76, 88}, {76, 95}, {77, 85}, {77, 86}, {77, 94}, {77, 98}, {78, 82}, {78, 93}, {78, 94}, {78, 94}, {78, 98}, {78, 98}, {79, 82}, {79, 82}, {79, 89}, {79, 93}, {79, 94}, {79, 94}, {79, 97}, {79, 98}, {80, 81}, {80, 83}, {80, 87}, {80, 91}, {80, 99}, {81, 84}, {81, 88}, {81, 88}, {81, 90}, {82, 86}, {82, 89}, {82, 93}, {82, 98}, {83, 87}, {83, 87}, {83, 88}, {83, 92}, {83, 96}, {84, 87}, {84, 91}, {84, 91}, {84, 91}, {84, 95}, {84, 96}, {84, 96}, {84, 99}, {84, 99}, {85, 86}, {85, 89}, {85, 94}, {86, 89}, {86, 94}, {86, 98}, {87, 92}, {87, 95}, {87, 95}, {87, 99}, {88, 90}, {88, 95}, {88, 96}, {88, 99}, {89, 93}, {89, 93}, {89, 98}, {90, 91}, {90, 99}, {92, 96}, {92, 96}, {92, 98}, {94, 96}, {94, 97}, {95, 96}, {95, 96}, {95, 96}, {96, 99}, {96, 99}};

        int compNum = 100; //number of computers

        int result = findConnectivity(myNet, compNum);
        System.out.println("Связность данной сети: " + result);
    }

    public static int findConnectivity(int[][] net, int numComps) {
        int connectivity = Integer.MAX_VALUE;

        //матрица смежности
        int matrix[][] = new int[numComps][numComps];

        //initialize
        for (int i = 0; i < numComps; i++) {
            for (int j = 0; j < numComps; j++) {
                matrix[i][j] = 0;
            }
        }

        // представляем нашу сеть в виде матрицы смежности: 1-соединены, 0-не соединены
        for (int i = 0; i < net.length; i++) {
            matrix[net[i][0]][net[i][1]] = 1;
            // у нас неориентированный граф
            matrix[net[i][1]][net[i][0]] = 1;
        }

        // тут в алгоритм вообще можно ввести любые числа s и t, так как мы в любом случае пройдем по всему графу
        //connectivity = falkerson(matrix, 0, 99, numComps);;

        // для каждой пары вершин считаем:
        for (int i = 0; i < numComps; i++) {
            for (int j = 0; j < numComps; j++) {
                if (i != j) {
                    int curConnectivity = falkerson(matrix, i, j, numComps);
                    if (curConnectivity < connectivity) {
                        connectivity = curConnectivity;
                    }
                }
            }
        }

        return connectivity;
    }

    //realization of falkerson + fill the parent array
    public static int falkerson(int[][] net, int s, int t, int numComps) {

        int maxFlow = 0;
        int[][] backNet = new int[numComps][numComps];
        int[] parents = new int[numComps];
        // заполняем
        for (int i = 0; i < numComps; i++) {
            for (int j = 0; j < numComps; j++) {
                backNet[i][j] = net[i][j];
            }
        }

        while (bfs(backNet, s, t, numComps, parents)) {
            int curFlow = Integer.MAX_VALUE;

            // go through a parents cycle
            for (int i = t; i != s; i = parents[i]) {
                //System.out.println("parent: " + u);
                int u = parents[i];
                if (backNet[u][i] < curFlow) {
                    curFlow = backNet[u][i];
                }
            }

            for (int i = t; i != s; i = parents[i]) {
                int u = parents[i];
                //System.out.println("parent: " + u + " flow = " + curFlow);
                backNet[i][u] += curFlow;
                backNet[u][i] -= curFlow;
            }

            maxFlow += curFlow;

        }
        return maxFlow;

    }

    private static boolean bfs(int[][] net, int s, int t, int num, int[] parent) {
        boolean visited[] = new boolean[num];
        LinkedList<Integer> vertices = new LinkedList<Integer>();

        for (int i = 0; i < num; ++i) {
            if (i != s) {
                visited[i] = false;
            }
        }

        vertices.add(s);
        visited[s] = true;
        parent[s] = Integer.MIN_VALUE; // here we can place any number <0

        while (vertices.size() > 0) {
            int u = vertices.getFirst();
            vertices.pollFirst();

            for (int v = 0; v < num; v++) {
                if (!visited[v]) {
                    if (net[u][v] > 0) {
                        visited[v] = true;
                        parent[v] = u;
                        vertices.add(v);
                    }
                }
            }
        }
        return visited[t];
    }


    @Deprecated
    // Топологически сортируем наш граф
    // Тут мы получаем топологически отсортированный список вершин, начиная с S
    private static int topologySort(int[][] net, int s, int t, int num) {
        boolean[] visited = new boolean[num];
        visited[s] = true;
        ArrayList<Integer> myTopology = new ArrayList<>();

        dfs(s, visited, net, num, myTopology);
        //System.out.println(myTopology);

        //reverse the list
        ArrayList<Integer> normalTopology = new ArrayList<>();
        for (int i = 0; i < num; i++) {
            if (myTopology.size() > 0) {
                normalTopology.add(myTopology.get(myTopology.size() - 1));
                myTopology.remove(myTopology.size() - 1);
            }
        }

        //System.out.println(normalTopology);

        int numVertices = normalTopology.size();
        int[] paths = new int[numVertices];
        for (int i = 0; i < numVertices; i++) {
            paths[i] = 0;
        }

        // either we;ve reached "t"
        boolean tMet = false;
        for (int i = numVertices - 1; i >= 0; i--) {
            int element = normalTopology.get(i);
            if (element == t) {
                paths[i] = 1;
                tMet = true;
                // System.out.println(element + "!!!!!!!!!!!!!!!!!!");
            } else if (tMet) {
                paths[i] = 0;
                for (int j = i + 1; j < numVertices; j++) {
                    //if there is an edge
                    if (net[normalTopology.get(i)][normalTopology.get(j)] > 0) {
                        //System.out.println("MM = " + net[normalTopology.get(i)][normalTopology.get(j)]);
                        paths[i] += net[normalTopology.get(i)][normalTopology.get(j)] * paths[j];
                    }
                }
            }
            //System.out.println(" i = " + normalTopology.get(i) + " || d = " + paths[i]);
        }
        return paths[0];
    }

    @Deprecated
    private static void dfs(int u, boolean[] visited, int[][] net, int netLen, ArrayList topology) {
        visited[u] = true;
        for (int i = 0; i < netLen; i++) {
            if (net[u][i] > 0 || net[i][u] > 0) {
                if (!visited[i]) {
                    dfs(i, visited, net, netLen, topology);
                }
            }
        }
        topology.add(u);
    }
}

